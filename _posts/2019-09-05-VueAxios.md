---
title: Axios和接口的使用
date: 2019-09-05 23:40:49
---
# Axios和接口的使用

## 1. 为什么使用接口?

​		在之前的HTML工作中,一般情况下使用的是后台模板渲染的方式,进行页面输出,现在的工作方式,是前后台分离,依赖ajax请求进行发送,但是ajax使用极其复杂

## 2. 常用ajax插件axios

Axios使用与Vue更加方便

## 3. 接口的使用(豆瓣api https://douban.uieee.com/v2/movie/in_theaters)

接口是以一个链接的方式出现,并且说明所要携带的数据 如果请求成功,那么服务器返回相应的数据

### (1) 跨域如何解决

a页面在我的服务器,请求我的数据

b页面不在我的服务器,请求我的数据(跨域)

1. 利用服务器进行重新请求

    利用自己的服务器,对跨域的服务器发送请求,然后把请求的数据转交给你

2. 服务器配置jsonp文件 就可以解决跨域

   在前台,如果要请求jsonp格式的话,需要在dataType属性中进行设置

## 4. axios进行 ajax请求数据

全局注册:

在 main.js 出口文件中

为何要全局注册?

通过全局注册可以使得每一个组件vue或者需要导入到index.html页面的其他分页面vue无需一个一个添加 axios.js文件

```
import axios from 'axios'				//因为 main最终引入到index.html页面实现了在全局使用
// 通过 proptotype 进行修改 Vue对象方法
Vue.prototype.axios = axios					全局注册
```

2. 如果按照正常写法,仍然会出现跨域问题
3. 反向代理解决跨域

## 5. 什么是反向代理和正向代理

#### 正向代理:

A同学在大众创业、万众创新的大时代背景下开启他的创业之路，目前他遇到的最大的一个问题就是启动资金，于是他决定去找马云爸爸借钱，可想而知，最后碰一鼻子灰回来了，情急之下，他想到一个办法，找关系开后门，经过一番消息打探，原来A同学的大学老师王老师是马云的同学，于是A同学找到王老师，托王老师帮忙去马云那借500万过来，当然最后事成了。不过马云并不知道这钱是A同学借的，马云是借给王老师的，最后由王老师转交给A同学。这里的王老师在这个过程中扮演了一个非常关键的角色，就是代理，也可以说是正向代理，王老师代替A同学办这件事，这个过程中，真正借钱的人是谁，马云是不知道的，这点非常关键。

我们常说的代理也就是只正向代理，正向代理的过程，它隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都被代理服务器代替来请求，某些科学上网工具扮演的就是典型的正向代理角色。用浏览器访问 谷歌时 时，被残忍的block，于是你可以在国外搭建一台代理服务器，让代理帮我去请求google.com，代理把请求返回的相应结构再返回给我。

https://pic4.zhimg.com/80/v2-07ededff1d415c1fa2db3fd89378eda0_hd.jpg

#### 反向代理

大家都有过这样的经历，拨打10086客服电话，可能一个地区的10086客服有几个或者几十个，你永远都不需要关心在电话那头的是哪一个，叫什么，男的，还是女的，漂亮的还是帅气的，你都不关心，你关心的是你的问题能不能得到专业的解答，你只需要拨通了10086的总机号码，电话那头总会有人会回答你，只是有时慢有时快而已。那么这里的10086总机号码就是我们说的反向代理。客户不知道真正提供服务人的是谁。

反向代理隐藏了真实的服务端，当我们请求 ww.baidu.com 的时候，就像拨打10086一样，背后可能有成千上万台服务器为我们服务，但具体是哪一台，你不知道，也不需要知道，你只需要知道反向代理服务器是谁就好了，ww.baidu.com 就是我们的反向代理服务器，反向代理服务器会帮我们把请求转发到真实的服务器那里去。Nginx就是性能非常好的反向代理服务器，用来做负载均衡。

https://pic4.zhimg.com/80/v2-816f7595d80b7ef36bf958764a873cba_hd.jpg

两者的区别在于代理的对象不一样：正向代理代理的对象是客户端，

反向代理代理的对象是服务端

```vue
//在 webpack的配置文件中 config/index.js中的proxyTable:{}下添加代码 注意
//webpack各个版本之间或许不一样;
proxyTable: {
      // 开始设置反向代理
      //命名 代理名
      '/api':{
        // 设置代理目标总地址
        target:'https://douban.uieee.com/v2/',
        // 是否重定向
        changeOrigin:true,
        // 从写路径 意思是 只要匹配到api的路径时,那么就跳转到'' 也就是 让匹配停止
        pathRewrite:{
          '^/api':''
        }
      }
    },

```

```vue
//接着 在需要请求接口的页面vue中 将 请求的url中 的 前部分目标地址替换成 反向代理时设置的名称
export default {
    methods:{
        getData(){
        //将 请求的url中 的 前部分目标地址替换成 反向代理时设置的名称
            this.axios.get('/api/movie/in_theaters',{	
                //请求的参数
                params:{
                    city:'北京'
                }
            }).then((data)=>{
                console.log(data)
            }).catch((err)=>{
                console.log(err)
            })
        }
    },
    created(){
        this.getData();
    }
};
```

#### 注意 如果在项目上线后 在苹果端能够使用,那必须要安装 https的ssl安全协议 如果没有以上请求 ,那么苹果会一致显示网络错误

